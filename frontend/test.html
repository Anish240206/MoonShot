<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Goal & Stash Tester</title>
  <style>
    body { font-family: sans-serif; }
    form { border: 1px solid #ccc; padding: 1em; margin-bottom: 1em; }
  </style>
</head>
<body>
  <h2>Create a Goal</h2>
  <form id="goalForm">
    <label>Goal Name: <input type="text" name="name" value="Kerala Trip" /></label><br />
    <label>Target Amount: <input type="number" name="target_amount" value="80000" /></label><br />
    <label>Start Date: <input type="date" name="start_date" value="2025-09-21" /></label><br />
    <label>End Date: <input type="date" name="end_date" value="2027-09-21" /></label><br />
    <label>Current Savings: <input type="number" name="current_savings" value="0" /></label><br />
    <label>Monthly Income: <input type="number" name="monthly_income" value="25000" /></label><br />
    <label>Monthly Emergency Stash: <input type="number" name="emergency_stash_monthly" value="500" /></label><br />
    <button type="submit">Create Goal & Get Recommendation</button>
  </form>

  <hr>

  <h2>Add to Emergency Stash</h2>
  <form id="emergencyForm">
    <label>Amount: <input type="number" name="amount" value="100" /></label><br />
    <button type="submit">Add to Stash</button>
  </form>
  <pre id="output"></pre>

  <script>

    document.getElementById("goalForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const form = new FormData(e.target);
      const body = Object.fromEntries(form.entries());

      body.target_amount = Number(body.target_amount);
      body.current_savings = Number(body.current_savings);
      body.monthly_income = Number(body.monthly_income);
      body.emergency_stash_monthly = Number(body.emergency_stash_monthly);

      const response = await fetch("http://127.0.0.1:5001/skarjams2025/us-central1/api/goal?userId=user123", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(body)
      });

      const result = await response.json();
      document.getElementById("output").textContent = 'Goal Response:\n' + JSON.stringify(result, null, 2);
    });


    document.getElementById("emergencyForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const form = new FormData(e.target);
      const body = {
        userId: 'user123',
        amount: Number(form.get('amount'))
      };

      const response = await fetch("http://127.0.0.1:5001/skarjams2025/us-central1/api/emergency/save", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(body)
      });

      const result = await response.json();
      document.getElementById("output").textContent = 'Emergency Stash Response:\n' + JSON.stringify(result, null, 2);
    });

  </script>
</body>
</html>